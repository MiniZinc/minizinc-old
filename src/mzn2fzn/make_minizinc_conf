#!/bin/sh
#----------------------------------------------------------------------------#
# vim: ts=4 sw=4 expandtab
#----------------------------------------------------------------------------#
# Copyright (C) 2009 The University of Melbourne and NICTA.
# See the file COPYING for license information.
#----------------------------------------------------------------------------#
# 
# File: make_minizinc_conf.
# Author: juliensf.
#
# This script is used to generate the file minizinc_conf.m based upon settings
# determined by the configure script.  It is intended to be invoked from the
# makefiles in g12/zinc/src/mzn2fzn rather than directly from the command line.
#
# Usage: make_minizinc_conf <install_dir> <major version> <minor version>
#   <patch version> <search_dir_sep> <date_string> <opt_flags>
#
#----------------------------------------------------------------------------#

if test "$#" -ne 7
then
    echo "$0: expected five arguments:"
    echo "$0: 1. the install directory"
    echo "$0: 2. the major version number"
    echo "$0: 3. the minor version number"
    echo "$0: 4. the patch version number"
    echo "$0: 5. the search dir separator character"
    echo "$0: 6. the date string"
    echo "$0: 7. the optimisation flags"
    exit 1
fi

INSTALL_PREFIX="$1"
MAJOR_VERSION="$2"
MINOR_VERSION="$3"
PATCH_VERSION="$4"
SEARCH_DIR_SEP_CHAR="$5"
BUILD_DATE="$6"
OPT_FLAGS="$7"

cat > minizinc_conf.m << END
%-----------------------------------------------------------------------------%
% vim: ft=mercury ts=4 sw=4 et wm=0 tw=0
%-----------------------------------------------------------------------------%
% Copyright (C) 2009 The University of Melbourne and NICTA.
% See the file COPYING for license information.
%-----------------------------------------------------------------------------%
% 
% This module has been automatically generated by the script
% make_minizinc_conf.
% DO NOT EDIT.
%
%----------------------------------------------------------------------------%

:- module minizinc_conf.
:- interface.
:- import_module char.

%----------------------------------------------------------------------------%
%
% Version information
%

:- func minizinc_major_version = string.
:- func minizinc_minor_version = string.
:- func minizinc_patch_version = string.

%----------------------------------------------------------------------------%
%
% Installation directory
%

:- func install_prefix = string.

%----------------------------------------------------------------------------%
%
% Search directory separator character
%

:- pred is_search_dir_separator(char::in) is semidet.

%----------------------------------------------------------------------------%
%
% Compilation environment
%

:- func minizinc_compilation_grade = string.

:- func minizinc_build_date = string.

:- func minizinc_opt_flags = string.

%----------------------------------------------------------------------------%
%----------------------------------------------------------------------------%

:- implementation.

minizinc_major_version = "$MAJOR_VERSION".

minizinc_minor_version = "$MINOR_VERSION".

minizinc_patch_version = "$PATCH_VERSION".

install_prefix = "$INSTALL_PREFIX".

is_search_dir_separator('$SEARCH_DIR_SEP_CHAR').

minizinc_compilation_grade = \$grade.

minizinc_build_date = "$BUILD_DATE".

minizinc_opt_flags = "$OPT_FLAGS".

%----------------------------------------------------------------------------%
:- end_module minizinc_conf.
%----------------------------------------------------------------------------%
END
